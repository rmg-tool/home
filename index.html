<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RMG Tools</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://unpkg.com/tabulator-tables@5.4.4/dist/css/tabulator.min.css" rel="stylesheet">
    <script src="https://unpkg.com/tabulator-tables@5.4.4/dist/js/tabulator.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

</head>
<body>
    <div id="loadingIndicator" style="display: none;">
        <i class="fas fa-spinner fa-spin"></i> <!-- Font Awesome spinning icon -->
    </div>
    
    
    <!-- Login Frame -->
    <div id="login-frame" class="container">
        <div class="left-section">
            <div class="image-container">
                <img src="material/log_in.png" alt="Illustration" />
            </div>
        </div>
        <div class="right-section">
            <div class="login-form">
                <div class="profile-pic">
                    <img src="material/avatar.png" alt="User Icon" />
                </div>
                <h2>WELCOME</h2>
                <form id="login-form">
                    <div class="input-group">
                        <!-- <label for="username">Username</label> -->
                        <input type="text" id="username" placeholder="Username">
                    </div>
                    <div class="input-group">
                        <!-- <label for="password">Password</label> -->
                        <input type="password" id="password" placeholder="Password">
                    </div>

                    <button type="submit" class="login-btn">LOGIN</button>
                </form>
            </div>
        </div>
    </div>
    

    <!-- Main Dashboard Frame -->
    <div id="welcome-frame" class="dashboard" style="display: none;">
        <!-- Sidebar -->
        <aside class="sidebar">
            <ul>
                <h2 id="welcome-message"></h2>
                <li onclick="showFrame('home')"><i class="fas fa-home icon"></i> Home</li>
                <li onclick="toggleSubmenu(event, 'inv_list', this)">

                        <i class="fa-solid fa-network-wired"></i>   
                        Inventory
                        <i class="fa-solid fa-chevron-down arrow" id="arrr"></i>
   
                    <ul class="submenu" id="inv_list">
                        <li onclick="showFrame('import')">Nh·∫≠p</li>
                        <li onclick="showFrame('export')">Xu·∫•t</li>
                        <li onclick="showFrame('mml')">MML</li>
                    </ul>
                </li>
                <li onclick="toggleSubmenu(event, 'ops_list', this)">

                    <i class="fa-solid fa-gears"></i>
                        OPS Management
                        <i class="fa-solid fa-chevron-down arrow"></i>
        
                    <ul class="submenu" id="ops_list">
                        <li onclick="showFrame('crm')">CRM</li>
                        <li onclick="showFrame('survey')">KH·∫¢O S√ÅT</li>
                        <li onclick="showFrame('design')">DESIGN + BOM</li>
                        <li onclick="showFrame('quotation')">QUOTATION</li>
                        <li onclick="showFrame('order')">ORDER RECEIVE</li>
                        <li onclick="showFrame('mfg')">MFG / PUR</li>
                        <li onclick="showFrame('delivery')">DELIVERY</li>
                        <li onclick="showFrame('payment')">PAYMENT</li>
                    </ul>
                    
                </li>

                <li onclick="toggleSubmenu(event, 'pur_list', this)">

                    <i class="fa-solid fa-cart-shopping"></i>
                    PUR Management
                    <i class="fa-solid fa-chevron-down arrow"></i>
        
                    <ul class="submenu" id="pur_list">
                        <li onclick="showFrame('pur_pr')">Purchasing Request</li>
                        <li onclick="showFrame('pur_po')">Purchase Order</li>
                        <li onclick="showFrame('pur_po_release')">PO Release</li>
                        <li onclick="showFrame('pur_pre_payment')">Pre-Payment</li>
                        <li onclick="showFrame('pur_po_receiving')">PO Receiving</li>
                        <li onclick="showFrame('pur_final_payment')">Final Payment</li>
                        <li onclick="showFrame('pur_po_complete')">PO Complete</li>
                        <li onclick="showFrame('pr_po_summary')">PR / PO Status</li>
                    </ul>
                    
                </li>

                <li onclick="showFrame('bom_creation')"> <i class="fa-solid fa-code-pull-request"></i> BOM Creation</li>
                <!-- <li onclick="showFrame('approve_center')"> <i class="fa-solid fa-check"></i> Approval Center</li> -->
                <li onclick="toggleSubmenu(event, 'approval_list', this)">

                    <i class="fa-solid fa-check"></i>
                        Approval Center
                        <i class="fa-solid fa-chevron-down arrow"></i>
        
                    <ul class="submenu" id="approval_list">
                        <li onclick="showFrame('bom_approval')">Bom</li>
                        <li onclick="showFrame('quotation_approval')">Quotation</li>
                        <li onclick="showFrame('pr_approval')">Purchase Request</li>
                        <li onclick="showFrame('po_1_approval')">PO Level 1</li>
                        <li onclick="showFrame('po_2_approval')">PO Level 2</li>
                        <li onclick="showFrame('po_3_approval')">PO Level 3</li>
                        <li onclick="showFrame('po_4_approval')">PO Level 4</li>
                    </ul>
                    
                </li>
                <li onclick="toggleSubmenu(event, 'export_list', this)">
    
                    <i class="fa-solid fa-download"></i>
                    Export Data
                    <i class="fa-solid fa-chevron-down arrow"></i>

                    <ul class="submenu" id="export_list">
                        <li onclick="showFrame('onhand')">Onhand</li>
                        <li onclick="showFrame('transaction_nhap')">Nh·∫≠p</li>
                        <li onclick="showFrame('transaction_xuat')">Xu·∫•t</li>
                        <li onclick="showFrame('export_pr')">Xu·∫•t PR / PO</li>
                        <!-- <li onclick="showFrame('export_po')">Xu·∫•t PO</li> -->
                    </ul>
                </li>
                <li><button id="logout-btn" class="logout-btn"> <i class="fa-solid fa-right-from-bracket"></i> LOGOUT</button></li>
            </ul>
        </aside>

        <!-- Main Content Area -->
        <main class="content">
            
            <!-- Frames for each section -->
            <div id="home" class="frame active">
                <h2 id="welcome"></h2>
                <h3 style="margin-bottom: 20px;">Last Updated: 2025-05-21 03:00 AM</h3>

                <div style="width: 600px; margin-top: 50px; max-height: 600px; overflow-y: auto;">
                    <h1>üìå RELEASE NOTE</h1>

                    <ul class="tool-list">
                        <li class="tool-item">
                        <div class="tool-title">21-05-2025 | Th√™m Module PO Complete</div>
                        <div class="tool-desc">C·∫≠p nh·∫≠t l·∫°i PO ch√≠nh th·ª©c c·ªßa kh√°ch h√†ng m√† l√∫c t·∫°o PR ch∆∞a c√≥</div>
                        <span class="badge-new">NEW</span>
                        </li>

                        <li class="tool-item">
                        <div class="tool-title">15-05-2025 | PDF PO Format</div>
                        <div class="tool-desc">Th√™m ch·ªØ k√Ω v√† con d·∫•u c√¥ng ty khi t·∫°o Purchase Order, ch·ªâ khi Gi·∫£m ƒë·ªëc Approve m·ªõi hi·ªÉn th·ªã m·ªôc v√† link t·∫£i PDF m·ªõi xu·∫•t hi·ªán</div>
                        </li>

                        <li class="tool-item">
                        <div class="tool-title">15-05-2025 | Th√™m module PR / PO Status</div>
                        <div class="tool-desc">Theo d√µi tr·∫°ng th√°i c·ªßa PR / PO ƒëang ·ªü b∆∞·ªõc n√†o v√† next step</div>
                        </li>

                        <li class="tool-item">
                        <div class="tool-title">15-05-2025 | Th√™m c·ªôt ng√†y nh·∫≠n h√†ng</div>
                        <div class="tool-desc">Th√™m c·ªôt ng√†y nh·∫≠n h√†ng ·ªü danh s√°ch ch·ªù x·ª≠ l√Ω ·ªü module PO RECEIVING</div>
                        </li>

                        <li class="tool-item">
                        <div class="tool-title">15-05-2025 | CANCEL PO</div>
                        <div class="tool-desc">System kh√¥ng hi·ªÉn th·ªã c√°c PR, PO ƒëa b·ªã cancel kh·ªèi danh s√°ch ch·ªù x·ª≠ l√Ω c·ªßa PURCHASING MANAGEMENT</div>
                        </li>

                        <li class="tool-item">
                        <div class="tool-title">15-05-2025 | Th√™m tr∆∞·ªùng data "ƒê∆°n gi√° / ƒê∆°n v·ªã" k√©o t·ª´ MML</div>
                        <div class="tool-desc">Th√™m tr∆∞·ªùng data "ƒê∆°n gi√° / ƒê∆°n v·ªã" k√©o t·ª´ MML khi l√†m PR</div>
                        </li>

                    </ul>
                </div>
                <!-- Th√™m h√¨nh ·∫£nh -->
                <!-- <img src="material/rmg_doanket.jpg" alt="RMG Technologies" style="width:100%;"/> -->
            </div>
            
                
            <div id="import" class="frame">
                <div id="secondaryModal" class="modal">
                    <div class="modal-content">
                        <span class="close-btn" onclick="closeModal()">x</span>
                        <h3>Ch·ªçn v·∫≠t t∆∞</h3>
                        <div id="modalOptions"></div>
                    </div>
                </div>
    
                <h1>Nh·∫≠p v·∫≠t t∆∞</h1>
                <div class="form-row">
                    <label for="warehouse">Ch·ªçn chi nh√°nh</label>
                    <select id="warehouse">
                        <!-- Options s·∫Ω ƒë∆∞·ª£c th√™m qua JavaScript -->
                    </select>
                </div>
                
                <div class="form-row">
                    <label for="material-type">Lo·∫°i v·∫≠t t∆∞</label>
                    <div id="found">
                        <input type="text" id="material-type" placeholder="Nh·∫≠p lo·∫°i v·∫≠t t∆∞">
                        <div id="dropdown" class="dropdown"></div>
                    </div>
                </div>

                <div class="form-row">
                    <label >T√™n v·∫≠t t∆∞</label>
                    <label id="sku_name_nhap"></label>
                </div>

                <div class="form-row">
                    <label >M√£ v·∫≠t t∆∞</label>
                    <label id="sku_id_nhap"></label>
                </div>

                <div class="form-row">
                    <label >ƒê∆°n v·ªã</label>
                    <label id="unit_nhap"></label>
                </div>

                <div class="form-row">
                    <label for="rmg_po_nhap">RMG's PO#</label>
                    <input type="text" id="rmg_po_nhap" placeholder="Nh·∫≠p m√£ PO RMG">
                </div>
                
                <div class="form-row">
                    <label for="supplier-code">M√£ nh√† cung c·∫•p</label>
                    <select id="supplier-code">
                        <!-- Options s·∫Ω ƒë∆∞·ª£c th√™m qua JavaScript -->
                    </select>
                </div>
                
                <div class="form-row">
                    <label for="quantity">Nh·∫≠p s·ªë l∆∞·ª£ng</label>
                    <input type="number" id="quantity" placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng" oninput="validateInput(this)">
                </div>
                
                <div class="form-row">
                    <label for="unit-price">Nh·∫≠p ƒë∆°n gi√°</label>
                    <input type="number" id="unit-price" placeholder="Nh·∫≠p ƒë∆°n gi√°" oninput="validateInput(this)">
                </div>
                
                <div class="form-row">
                    <label for="expiry-date">Ng√†y h·∫øt h·∫°n</label>
                    <input type="date" id="expiry-date" placeholder="yyyy-mm-dd">
                </div>
                
                <div class="form-row">
                    <label for="storage-location">V·ªã tr√≠ l∆∞u kho</label>
                    <input type="text" id="storage-location" placeholder="Nh·∫≠p v·ªã tr√≠ l∆∞u kho">
                    <div id="error-message" style="color: red; display: none;">V·ªã tr√≠ kh√¥ng h·ª£p l·ªá</div>
                </div>

                <div id="button_group_nhap">
                    <button class="submit-btn" onclick="submit_nhap()">Submit</button>
                    <button class="reset-btn" onclick="reset_nhap()">Reset</button>
                </div>
            </div>
            
            <div id="export" class="frame">
                <div id="secondaryModal2" class="modal">
                    <div class="modal-content">
                        <span class="close-btn" onclick="closeModal()">x</span>
                        <h3>Ch·ªçn v·∫≠t t∆∞</h3>
                        <div id="modalOptions2"></div>
                    </div>
                </div>
            
                <div id="foundTableModal" style="display: none;" class="modal2">
                    <div class="modal-content2">
                        <span class="close-button" onclick="closeFoundTableModal()">√ó</span>
                        <h3>Th√¥ng tin t√¨m th·∫•y</h3>
                        <table id="foundTable" border="1">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Location</th>
                                    <th>Quantity</th>
                                    <th>Expiry Date</th>
                                    <th>Inbound Date</th>
                                    <th>Unit Price</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <h1>Xu·∫•t v·∫≠t t∆∞</h1>
                <div class="form-row">
                    <label for="warehouse_xuat">Ch·ªçn chi nh√°nh</label>
                    <select id="warehouse_xuat">
                        <!-- Options s·∫Ω ƒë∆∞·ª£c th√™m qua JavaScript -->
                    </select>
                </div>

                <div class="form-row">
                    <label for="customer_name">T√™n ng∆∞·ªùi nh·∫≠n h√†ng</label>
                    <input type="text" id="customer_name" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi nh·∫≠n h√†ng">
                </div>
                
                <div class="form-row">
                    <label for="order_xuat">Xu·∫•t cho ƒë∆°n h√†ng</label>
                    <input type="text" id="order_xuat" placeholder="Nh·∫≠p m√£ ƒë∆°n h√†ng">
                </div>

                <div class="form-row">
                    <label for="material-type_xuat">Lo·∫°i v·∫≠t t∆∞</label>
                    <div id="found_xuat">
                        <input type="text" id="material-type_xuat" placeholder="Nh·∫≠p lo·∫°i v·∫≠t t∆∞">
                        <div id="dropdown_xuat" class="dropdown"></div>
                    </div>
                </div>

                <div class="form-row">
                    <label >T√™n v·∫≠t t∆∞</label>
                    <label id="sku_name_xuat"></label>
                </div>

                <div class="form-row">
                    <label >M√£ v·∫≠t t∆∞</label>
                    <label id="sku_id_xuat"></label>
                </div>

                <div class="form-row">
                    <label >ƒê∆°n v·ªã</label>
                    <label id="unit_xuat"></label>
                </div>

                <div class="form-row">
                    <label >Xu·∫•t cho ƒë∆°n gi√°</label>
                    <label id="price_at_xuat"></label>
                </div>

                <div class="form-row">
                    <label >V·ªã tr√≠</label>
                    <label id="loc_xuat"></label>
                </div>

                <div class="form-row">
                    <label >Ng√†y h·∫øt h·∫°n</label>
                    <label id="exp_date_xuat"></label>
                </div>

                <div class="form-row">
                    <label >Ng√†y nh·∫≠p</label>
                    <label id="ib_date_xuat"></label>
                </div>

                <div class="form-row">
                    <label >T·ªìn hi·ªán t·∫°i</label>
                    <label id="cur_onhand"></label>
                </div>

                <div class="form-row">
                    <label for="quantity_xuat">Nh·∫≠p s·ªë l∆∞·ª£ng</label>
                    <input type="number" id="quantity_xuat" placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng" oninput="validateInput(this)">
                </div>


                <div id="button_group_xuat">
                    <button class="submit-btn" onclick="submit_xuat()">Submit</button>
                    <button class="reset-btn" onclick="reset_xuat()">Reset</button>
                </div>

                <div id="tempLabel" style="display: none; background-color: red; color: white; padding: 5px;">Kh√¥ng c√≥ k·∫øt qu·∫£</div>
            </div>
            <div id="mml" class="frame">
                <h1>Meterials Master List</h1>
                
                <div class="form-row">
                    <label for="material-type_mml">Lo·∫°i v·∫≠t t∆∞</label>
                    <input type="text" id="material-type_mml" placeholder="Nh·∫≠p lo·∫°i v·∫≠t t∆∞">
                </div>

                <div class="form-row">
                    <label for="sku_name_mml">T√™n v·∫≠t t∆∞</label>
                    <input type="text" id="sku_name_mml" placeholder="Nh·∫≠p T√™n v·∫≠t t∆∞">
                </div>

                <div class="form-row">
                    <label for="sku_id_mml">M√£ v·∫≠t t∆∞</label>
                    <input type="text" id="sku_id_mml" placeholder="Nh·∫≠p M√£ v·∫≠t t∆∞">
                </div>

                <div class="form-row">
                    <label for="mb_code_mml">M√£ nh√† SX</label>
                    <input type="text" id="mb_code_mml" placeholder="Nh·∫≠p M√£ NSX">
                </div>

                <div class="form-row">
                    <label for="price_mml">ƒê∆°n gi√°</label>
                    <input type="number" id="price_mml" placeholder="ƒê∆°n gi√°" oninput="validateInput(this)">
                </div>

                <div class="form-row">
                    <label for="supplier_id_mml">M√£ nh√† cung c·∫•p</label>
                    <input type="text" id="supplier_id_mml" placeholder="Nh·∫≠p M√£ nh√† cung c·∫•p">
                </div>

                <div class="form-row">
                    <label for="supplier_name_mml">T√™n nh√† cung c·∫•p</label>
                    <input type="text" id="supplier_name_mml" placeholder="Nh·∫≠p T√™n nh√† cung c·∫•p">
                </div>

                <div class="form-row">
                    <label for="unit_mml">ƒê∆°n v·ªã</label>
                    <select id="unit_mml">
                        <!-- <option value=""></option>
                        <option value="B·ªãch">B·ªãch</option>
                        <option value="B·ªô">B·ªô</option>
                        <option value="C√°i">C√°i</option>
                        <option value="C√¢y">C√¢y</option>
                        <option value="Chai">Chai</option>
                        <option value="Cu·ªôn">Cu·ªôn</option>
                        <option value="H·ªôp">H·ªôp</option>
                        <option value="Kg">Kg</option>
                        <option value="Lit">Lit</option>
                        <option value="M√©t">M√©t</option>
                        <option value="S·ª£i">S·ª£i</option>
                        <option value="T·∫•m">T·∫•m</option>
                        <option value="T√∫i">T√∫i</option>
                        <option value="M3">M3</option> -->
                    </select>
                </div>

                <div id="button_group_mml">
                    <button class="submit-btn" onclick="submit_mml()">Submit</button>
                    <button class="reset-btn" onclick="reset_mml()">Reset</button>
                </div>
            </div>

            <div id="crm" class="frame">
                <h1>CRM OPS Management</h1>
                <div class="form-row">
                    <label for="wh_crm">Ch·ªçn chi nh√°nh</label>
                    <select id="wh_crm"></select>
                </div>

                <div class="form-row">
                    <label for="customer_crm">Kh√°ch h√†ng</label>
                    <div id="found_crm">
                        <input type="text" id="customer_crm" placeholder="Nh·∫≠p t√™n kh√°ch h√†ng">
                        <div id="dropdown_crm" class="dropdown"></div>
                    </div>
                </div>

                <div class="form-row">
                    <label>M√£ kh√°ch h√†ng</label>
                    <label id="customer_id_crm"></label>
                </div>

                <div class="form-row">
                    <label for="content_crm">N·ªôi dung</label>
                    <textarea id="content_crm" placeholder="Nh·∫≠p n·ªôi dung" rows="4"></textarea>
                </div>

                
                <div id="button_group_crm">
                    <button class="reset-btn" onclick="reset_crm()">Reset</button>
                    <button class="submit-btn" onclick="crm_post()" id="button_crm">Kh·∫£o s√°t</button>
                </div>
                <button class="submit-btn" onclick="crm_to_design()" id="button_crm_to_quotation" style="background-color: yellow; color: black;">B√°o gi√°</button>
            </div>

            <div id="survey" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>KH·∫¢O S√ÅT OPS Management</h1>
                        <form id="uploadForm" method="post" action="https://script.google.com/macros/s/AKfycbz3sDtQ9BzRkwEzNdS6nIm8Vus3xqV-t8wqbQs3BsGdipihibNc3W_hJmPIfoIqImSBbg/exec" onsubmit="return submitForm_survey();">
                            <div class="form-row">
                                <label for="surveyCrmNumber">CRM #</label>
                                <input type="text" id="surveyCrmNumber" placeholder="Nh·∫≠p CRM#">
                            </div>
                            <div class="form-row">
                                <label>Ng∆∞·ªùi t·∫°o</label>
                                <label id="operator_show_survey"></label>
                            </div>
                            <div class="form-row">
                                <label>N·ªôi dung</label>
                                <label id="content_show_survey"></label>
                            </div>
                            <div class="form-row">
                                <label for="totalHours">T·ªïng gi·ªù l√†m</label>
                                <input type="text" id="totalHours" placeholder="Nh·∫≠p t·ªïng gi·ªù l√†m" oninput="validateInput(this)">
                            </div>
                            <div class="form-row">
                                <label for="surveyContent">N·ªôi dung</label>
                                <textarea id="surveyContent" placeholder="Nh·∫≠p n·ªôi dung" rows="4"></textarea>
                            </div>
                        </form>

                        
                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload" onchange="LoadFile(event)" required multiple><br><br>

                            <input type="hidden" id="fileData" name="fileData">
                            <input type="hidden" id="mimeType" name="mimeType">
                            <input type="hidden" id="fileName" name="fileName">
                        </div>
                        <label>L∆∞u √Ω: ƒê√≠nh k√®m t·ªëi ƒëa 3 files v√† m·ªói file kh√¥ng qu√° 10MB</label><br>

                        <div id="button_group_survey">
                            <button class="reset-btn" onclick="reset_survey()">Reset</button>
                            <button id="submitButton_survey" class="submit-btn" onclick="submitForm_survey()">Thi·∫øt k·∫ø</button>
                        </div>
                        <button id="cancelSurvey" class="cancel-btn">CANCEL</button>

                        <!-- Modal for Survey and Design + BOM (input reason) -->
                        <div id="reasonModalSurvey" class="modal">
                            <div class="modal-content">
                                <h3>L√Ω do h·ªßy</h3>
                                <!-- <input type="text" id="cancelReasonSurvey" placeholder="Nh·∫≠p l√Ω do h·ªßy"> -->
                                <textarea id="cancelReasonSurvey" placeholder="Nh·∫≠p n·ªôi dung" rows="4"></textarea>
                                <button onclick="confirmCancel('reasonModalSurvey')">X√°c nh·∫≠n h·ªßy</button>
                                <button onclick="closeModal('reasonModalSurvey')">ƒê√≥ng</button>
                            </div>
                        </div>
                    </div>
                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_survey" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>
                    </div>
                </div> 
            </div>

            <div id="design" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>DESIGN + BOM</h1>

                        <div class="form-row">
                            <label for="designCrmNumber">CRM#</label>
                            <input type="text" id="designCrmNumber" placeholder="Nh·∫≠p CRM#">
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o</label>
                            <label id="operator_show_design"></label>
                        </div>
                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <label id="content_show_design"></label>
                        </div>
                        <div class="form-row">
                            <label>File ƒë√≠nh k√®m</label>
                            <a id="link_show_design" href="#" target="_blank"></a>
                        </div>

                        <div class="form-row">
                            <label for="designBomNumber">BOM#</label>
                            <input type="text" id="designBomNumber" placeholder="Nh·∫≠p BOM#">
                        </div>

                        <div class="form-row">
                            <label for="designTotalPrice">T·ªïng gi√° tr·ªã BOM</label>
                            <input type="text" id="designTotalPrice" placeholder="Nh·∫≠p t·ªïng gi√° tr·ªã BOM">
                        </div>

                        <div class="form-row">
                            <label for="designTotalHour">T·ªïng gi·ªù l√†m</label>
                            <input type="text" id="designTotalHour" placeholder="Nh·∫≠p t·ªïng gi·ªù l√†m" oninput="validateInput(this)">
                        </div>

                        <div class="form-row">
                            <label for="designProductName">T√™n s·∫£n ph·∫©m</label>
                            <textarea id="designProductName" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m" rows="4"></textarea>
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload2" onchange="LoadFile2(event)" required multiple><br><br>

                            <input type="hidden" id="fileData2" name="fileData2">
                            <input type="hidden" id="mimeType2" name="mimeType2">
                            <input type="hidden" id="fileName2" name="fileName2">
                        </div>
                        <label>L∆∞u √Ω: ƒê√≠nh k√®m t·ªëi ƒëa 3 files v√† m·ªói file kh√¥ng qu√° 10MB</label><br>


                        <div id="button_group_design">
                            <button class="reset-btn" onclick="reset_design()">Reset</button>
                            <button id="submitButton_design" class="submit-btn" onclick="submitForm_design()">B√°o gi√°</button>
                        </div>
                        <button id="cancelDesign" class="cancel-btn">CANCEL</button>

                        <div id="reasonModalDesignBom" class="modal">
                            <div class="modal-content">
                                <h3>L√Ω do h·ªßy</h3>
                                <input type="text" id="cancelReasonDesignBom" placeholder="Nh·∫≠p l√Ω do h·ªßy">
                                <button onclick="confirmCancel('reasonModalDesignBom')">X√°c nh·∫≠n h·ªßy</button>
                                <button onclick="closeModal('reasonModalDesignBom')">ƒê√≥ng</button>
                            </div>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_design" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>

                        <h1 style="margin-top: 50px;">Danh s√°ch b·ªã Reject</h1>

                        <div id="table-container_design2" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>
                    </div>
                </div> 

            </div>

            <div id="quotation" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>QUOTATION</h1>

                        <div class="form-row">
                            <label for="quotationCrmNumber">CRM#</label>
                            <input type="text" id="quotationCrmNumber" placeholder="Nh·∫≠p CRM#">
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o</label>
                            <label id="operator_show_quotation"></label>
                        </div>

                        <div class="form-row">
                            <label>File ƒë√≠nh k√®m</label>
                            <a id="link_show_quotation" href="#" target="_blank"></a>
                        </div>

                        <div class="form-row">
                            <label for="quotationTotalPrice">Gi√° tr·ªã ƒë∆°n h√†ng + VAT</label>
                            <input type="text" id="quotationTotalPrice" placeholder="Nh·∫≠p gi√° tr·ªã ƒë∆°n h√†ng + VAT" oninput="validateInput(this)">
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload3" onchange="LoadFile3(event)" required multiple><br><br>

                            <input type="hidden" id="fileData3" name="fileData3">
                            <input type="hidden" id="mimeType3" name="mimeType3">
                            <input type="hidden" id="fileName3" name="fileName3">
                        </div>
                        <label>L∆∞u √Ω: ƒê√≠nh k√®m t·ªëi ƒëa 3 files v√† m·ªói file kh√¥ng qu√° 10MB</label><br>

                        <!-- <button onclick="openModal('reasonModalQuotation')" class="submit-btn">CANCEL</button> -->
                        <!-- <button class="submit-btn">CH·ªú NH·∫¨N ƒê∆†N H√ÄNG</button> -->
                        <div id="button_group_quotation">
                            <button class="reset-btn" onclick="reset_quotation()">Reset</button>
                            <button id="submitButton_quotation" class="submit-btn" onclick="submitForm_quotation()">Ch·ªù nh·∫≠n ƒë∆°n h√†ng</button>
                        </div>
                        <button id="cancelQuotation" class="cancel-btn">CANCEL</button>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_quotation" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>

                        <h1 style="margin-top: 50px;">Danh s√°ch b·ªã Reject</h1>

                        <div id="table-container_quotation2" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="order" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>ORDER RECEIVE</h1>

                        <div class="form-row">
                            <label for="orderQuotationNumber">QUOTATION#</label>
                            <input type="text" id="orderQuotationNumber" placeholder="Nh·∫≠p QUOTATION#">
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o</label>
                            <label id="operator_show_order"></label>
                        </div>

                        <div class="form-row">
                            <label>File ƒë√≠nh k√®m</label>
                            <a id="link_show_order" href="#" target="_blank"></a>
                        </div>

                        <div class="form-row">
                            <label>N·ªôi dung CRM</label>
                            <label id="crm_content_order"></label>
                        </div>

                        <!-- <div class="form-row">
                            <label>N·ªôi dung QUOTATION</label>
                            <label id="quotation_content_order"></label>
                        </div> -->
                        
                        <div class="form-row">
                            <label for="orderOrderID">CUSTOMER ORDER #</label>
                            <input type="text" id="orderOrderID" placeholder="Nh·∫≠p m√£ ƒë∆°n h√†ng">
                        </div>

                        <div class="form-row">
                            <label for="orderDate">Ng√†y giao h√†ng</label>
                            <input type="date" id="orderDate" placeholder="Ch·ªçn ng√†y giao h√†ng">
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload4" onchange="LoadFile4(event)" required multiple><br><br>

                            <input type="hidden" id="fileData4" name="fileData4">
                            <input type="hidden" id="mimeType4" name="mimeType4">
                            <input type="hidden" id="fileName4" name="fileName4">
                        </div>
                        <label>L∆∞u √Ω: ƒê√≠nh k√®m t·ªëi ƒëa 3 files v√† m·ªói file kh√¥ng qu√° 10MB</label><br>

                        <div id="button_group_order">
                            <button class="reset-btn" onclick="reset_order()">Reset</button>
                            <button id="submitButton_order" class="submit-btn" onclick="submitForm_order()">MFG / PUR</button>
                        </div>
                        <button id="cancelOrder" class="cancel-btn">CANCEL</button>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_order" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>
                        
                    </div>
                </div>
            </div>

            <div id="mfg" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>MFG / PUR</h1>
            
                        <div class="form-row">
                            <label for="mfgCrm">CRM#</label>
                            <input type="text" id="mfgCrm" placeholder="Nh·∫≠p CRM#">
                        </div>
            
                        <div class="form-row">
                            <label>M√£ kh√°ch h√†ng</label>
                            <label id="mfgCustomerID"></label>
                        </div>
            
                        <div class="form-row">
                            <label>M√£ ƒë∆°n h√†ng</label>
                            <label id="mfgCustomerName"></label>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o</label>
                            <label id="operator_show_mfg"></label>
                        </div>

                        <div class="form-row">
                            <label>File ƒë√≠nh k√®m</label>
                            <a id="link_show_mfg" href="#" target="_blank"></a>
                        </div>
            
                        <div class="form-row">
                            <label for="mfgContent">N·ªôi dung</label>
                            <textarea id="mfgContent" placeholder="Nh·∫≠p n·ªôi dung" rows="4"></textarea>
                        </div>
            
                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload5" onchange="LoadFile5(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData5" name="fileData5">
                            <input type="hidden" id="mimeType5" name="mimeType5">
                            <input type="hidden" id="fileName5" name="fileName5">
                        </div>
                        <label>L∆∞u √Ω: ƒê√≠nh k√®m t·ªëi ƒëa 3 files v√† m·ªói file kh√¥ng qu√° 10MB</label><br>
            
                        <div id="button_group_mfg">
                            <button class="reset-btn" onclick="reset_mfg()">Reset</button>
                            <button id="submitButton_mfg" class="submit-btn" onclick="submitForm_mfg()">Y√™u c·∫ßu giao h√†ng</button>
                        </div>
                    </div>
            
                    
                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_mfg" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>
                        
                    </div>
                </div>
            </div>
            

            <div id="delivery" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>DELIVERY</h1>

                        <div class="form-row">
                            <label for="deliveryCrm">CRM#</label>
                            <input type="text" id="deliveryCrm" placeholder="Nh·∫≠p CRM#">
                        </div>
            
                        <div class="form-row">
                            <label>M√£ kh√°ch h√†ng</label>
                            <label id="deliveryCustomerID"></label>
                        </div>
            
                        <div class="form-row">
                            <label>M√£ ƒë∆°n h√†ng</label>
                            <label id="deliveryCustomerName"></label>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o</label>
                            <label id="operator_show_delivery"></label>
                        </div>

                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <label id="content_show_delivery"></label>
                        </div>

                        <div class="form-row">
                            <label>File ƒë√≠nh k√®m</label>
                            <a id="link_show_delivery" href="#" target="_blank"></a>
                        </div>

                        <div class="form-row">
                            <label for="deliveryDate">Ng√†y thanh to√°n</label>
                            <input type="date" id="deliveryDate">
                        </div>
            
                        <div class="form-row">
                            <label for="deliveryContent">N·ªôi dung</label>
                            <textarea id="deliveryContent" placeholder="Nh·∫≠p n·ªôi dung" rows="4"></textarea>
                        </div>
            
                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload6" onchange="LoadFile6(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData6" name="fileData6">
                            <input type="hidden" id="mimeType6" name="mimeType6">
                            <input type="hidden" id="fileName6" name="fileName6">
                        </div>
                        <label>L∆∞u √Ω: ƒê√≠nh k√®m t·ªëi ƒëa 3 files v√† m·ªói file kh√¥ng qu√° 10MB</label><br>
            
                        <div id="button_group_delivery">
                            <button class="reset-btn" onclick="reset_delivery()">Reset</button>
                            <button id="submitButton_delivery" class="submit-btn" onclick="submitForm_delivery()">Y√™u c·∫ßu thanh to√°n</button>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_delivery" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>
                    </div>
                </div>
            </div>
            <div id="payment" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>PAYMENT</h1>

                        <div class="form-row">
                            <label for="paymentCrm">CRM#</label>
                            <input type="text" id="paymentCrm" placeholder="Nh·∫≠p CRM#">
                        </div>
            
                        <div class="form-row">
                            <label>M√£ kh√°ch h√†ng</label>
                            <label id="paymentCustomerID"></label>
                        </div>
            
                        <div class="form-row">
                            <label>M√£ ƒë∆°n h√†ng</label>
                            <label id="paymentCustomerName"></label>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o</label>
                            <label id="operator_show_payment"></label>
                        </div>

                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <label id="content_show_payment"></label>
                        </div>

                        <div class="form-row">
                            <label>File ƒë√≠nh k√®m</label>
                            <a id="link_show_payment" href="#" target="_blank"></a>
                        </div>
            
                        <div class="form-row">
                            <label for="paymentContent">N·ªôi dung</label>
                            <textarea id="paymentContent" placeholder="Nh·∫≠p n·ªôi dung" rows="4"></textarea>
                        </div>
            
            
                        <div id="button_group_payment">
                            <button class="reset-btn" onclick="reset_payment()">Reset</button>
                            <button id="submitButton_payment" class="submit-btn" onclick="submitForm_payment()">ƒê√£ nh·∫≠n thanh to√°n</button>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_payment" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <!-- Table will be dynamically generated and added here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="bom_creation" class="frame">
                <h1>BOM Creation</h1>

                <div class="scorecard">
                    <div class="card" id="doneCard">
                      <p>BOM m·ªõi</p>
                      <h1 id="doneValue">0</h1>
                    </div>
                    <div class="card" id="pendingCard">
                      <p>BOM t·∫°m</p>
                      <h1 id="pendingValue">0</h1>
                    </div>
                </div>
                <p style="display: none;" id="getBomLoading">ƒêang l·∫•y d·ªØ li·ªáu ...</p>

                <button style="font-size: 20px; padding: 5px; width: 200px; height: 50px;font-weight: bold;margin-top: 25px;" onclick="showModal_bom()">T·∫°o BOM m·ªõi</button>
                <button style="font-size: 20px; padding: 5px; width: 200px; height: 50px;font-weight: bold;margin-top: 50px; margin-left: 15px;" onclick="showModal_bom_draft()">Load BOM t·∫°m</button>

                <h2 style="margin-top: 20px; margin-bottom: 10px;">L·ªçc BOM ƒë√£ t·∫°o</h2>
                <!-- B·ªô l·ªçc -->
                <div class="filter-container">
                    <label style="margin-right: 20px;">Ng√†y nh·∫≠p: <input type="date" id="filter-date"></label>
                    <label>Chi nh√°nh:
                        <select id="filter-branch" style="margin-right: 20px;">
                            <option value="">T·∫•t c·∫£</option>
                            <option value="HCM">HCM</option>
                            <option value="QN">QN</option>
                            <option value="HN">SG</option>
                            <option value="SG">BN</option>
                        </select>
                    </label>
                    <label>Operator:
                        <select id="filter-operator" style="margin-right: 20px;">
                            <option value="">T·∫•t c·∫£</option>
                        </select>
                    </label>
                </div>

                <button id="clear-bom-link-filter" onclick="clear_filter()">Clear Filter</button>
                <button onclick="displayTableData()">Refresh</button>

                <!-- fd -->
                <div class="scrollable-frame">
                    <table id="bomLinkTable">
                        <thead>
                            <tr>
                                <th>Ng√†y nh·∫≠p</th>
                                <th>CRM#</th>
                                <th>BOM#</th>
                                <th>BOM Name</th>
                                <th>Kh√°ch h√†ng</th>
                                <th>Chi nh√°nh</th>
                                <th>Operator</th>
                                <th>PDF</th>
                                <th>Folder</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div class="bom-modal" id="bom-draft-modal">
                    <div class="modal-content">
                      <h2>Ch·ªçn BOM ƒë√£ t·∫°m l∆∞u</h2>
                      <div>
                        <select id="bomDraftDropdown"></select>
                      </div>
                    </div>
                  </div>

                <div class="bom-modal" id="bom-modal">
                    <div class="bom-modal-content">
                      <h2 class="bom-title">BOM Creation</h2>
                
                      <!-- Frame 1 -->
                      <div class="bom-frame">
                        <div class="bom-frame-title">Th√¥ng tin ch√≠nh:</div>
                        <div class="bom-row">
                          <div class="bom-left">
                            <div class="bom-input-group">
                              <label for="bom-crm">CRM#:</label>
                              <!-- <input type="text" id="bom-crm" /> -->
                              <select id="bom-crm"></select>
                            </div>
                            <div class="bom-input-group">
                                <label for="bom-name">T√™n BOM:</label>
                                <input type="text" id="bom-name" />
                            </div>
                        </div>
                          <div class="bom-right">
                            <div class="bom-input-group">
                                <label>Kh√°ch h√†ng:</label>
                                <label style="width: 100%; margin-top: 15px;" id="bom-customerID"></label>
                                <label style="width: 100%; margin-top: 15px;" id="bom-customerName"></label>
                                <label style="width: 100%; margin-top: 15px;" id="bom-wh"></label>
                                <label style="width: 100%; margin-top: 15px;" id="bom-crm-show"></label>
                        </div>

                            
                          </div>
                        </div>
                      </div>
                
                      <!-- Table Frame 2 -->
                      <div class="bom-frame">
                        <div class="bom-frame-title">Danh m·ª•c v·∫≠t t∆∞</div>
                        <button class="show-modal-button" onclick="showAddItemModal()">Th√™m v·∫≠t t∆∞</button>
                        <div style="overflow-x: auto;"> <!-- Th√™m overflow-x ƒë·ªÉ c√≥ cu·ªôn ngang -->
                            <table class="bom-table" id="bom-item-table">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Lo·∫°i v·∫≠t t∆∞</th>
                                        <th>T√™n v·∫≠t t∆∞</th>
                                        <th>M√£ v·∫≠t t∆∞</th>
                                        <th>ƒê∆°n v·ªã</th>
                                        <th>S·ªë l∆∞·ª£ng c·∫ßn</th>
                                        <th>S·ªë l∆∞·ª£ng t·ªìn kho hi·ªán c√≥</th>
                                        <th>S·ªë l∆∞·ª£ng c·∫ßn mua th√™m</th>
                                        <th>Gi√° / ƒê∆°n v·ªã (d·ª± ki·∫øn)</th>
                                        <th>T·ªïng gi√°</th>
                                        <th>H√†nh ƒë·ªông</th> <!-- Th√™m c·ªôt H√†nh ƒë·ªông -->
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        <label class="bom-total-row" id="bom-total-price" style="font-size: 30px; font-weight: bold;">T·ªïng gi√° tr·ªã: -</label>
                      </div>
                
                      <!-- Add Item Modal -->
                      <div class="bom-modal" id="add-item-modal">

                        <div id="secondaryModal_bom" class="modal">
                            <div class="modal-content" style="width: 100%;">
                                <span class="close-btn" onclick="closeModal()">x</span>
                                <h3>Ch·ªçn v·∫≠t t∆∞</h3>
                                <div id="modalOptions_bom"></div>
                            </div>
                        </div>

                        <div class="bom-modal-content">
                          <h2 class="bom-title">Th√™m v·∫≠t t∆∞</h2>
                          <div class="bom-input-group">
                            <label for="item-type">Lo·∫°i v·∫≠t t∆∞: (C√≥ g·ª£i √Ω)</label>
                            <input type="text" id="item-type" />
                            <div id="dropdown_bom" class="dropdown"></div>
                          </div>
                          <div class="bom-input-group">
                            <label style="background-color: lightgreen; padding: 5px;" for="item-quantity-needed">S·ªë l∆∞·ª£ng c·∫ßn:</label>
                            <input type="number" id="item-quantity-needed" />
                          </div>

                          <div class="bom-buttons">
                            <button class="bom-save" onclick="addItem()">Th√™m v√†o</button>
                            <button class="bom-clear" onclick="hideAddItemModal()">H·ªßy</button>
                          </div>

                          <div class="bom-input-group">
                            <label for="item-name">T√™n v·∫≠t t∆∞:</label>
                            <input type="text" id="item-name" disabled />
                          </div>
                          <div class="bom-input-group">
                            <label for="item-code">M√£ v·∫≠t t∆∞:</label>
                            <input type="text" id="item-code" disabled />
                          </div>
                          <div class="bom-input-group">
                            <label for="item-unit">ƒê∆°n v·ªã:</label>
                            <input type="text" id="item-unit" disabled />
                          </div>
                          
                          <div class="bom-input-group">
                            <label for="item-stock">S·ªë l∆∞·ª£ng t·ªìn kho hi·ªán c√≥:</label>
                            <input type="number" id="item-stock" disabled />
                          </div>
                          <div class="bom-input-group">
                            <label for="item-quantity-buy">S·ªë l∆∞·ª£ng c·∫ßn mua th√™m:</label>
                            <input type="number" id="item-quantity-buy" disabled />
                          </div>
                          <div class="bom-input-group">
                            <label for="item-price">Gi√° / ƒê∆°n v·ªã (d·ª± ki·∫øn):</label>
                            <input type="number" id="item-price" disabled />
                          </div>
                          
                        </div>
                      </div>
                
                      <!-- Frame 3 -->
                      <div class="bom-frame">
                        <div class="bom-frame-title">Danh m·ª•c thi·∫øt b·ªã</div>
                        <table class="bom-table" id="table_asset">
                          <thead>
                            <tr>
                              <th>STT</th>
                              <th>Thi·∫øt b·ªã</th>
                              <th>ƒê∆°n v·ªã</th>
                              <th>S·ªë gi·ªù c·∫ßn</th>
                              <th>Gi√° / ƒê∆°n v·ªã</th>
                              <th>T·ªïng gi√°</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>1</td>
                              <td>M√ÅY CNC</td>
                              <td>Gi·ªù</td>
                              <td><input type="number" /></td>
                              <td>170,000</td>
                              <td>-</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>M√ÅY PHAY</td>
                                <td>Gi·ªù</td>
                                <td><input type="number" /></td>
                                <td>90,000</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>M√ÅY TI·ªÜN</td>
                                <td>Gi·ªù</td>
                                <td><input type="number" /></td>
                                <td>90,000</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>M√ÅY C·∫ÆT</td>
                                <td>Gi·ªù</td>
                                <td><input type="number" /></td>
                                <td>90,000</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>M√ÅY H√ÄN</td>
                                <td>Gi·ªù</td>
                                <td><input type="number" /></td>
                                <td>120,000</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>C√ÅC LO·∫†I M√ÅY KH√ÅC</td>
                                <td>Gi·ªù</td>
                                <td><input type="number" /></td>
                                <td>100,000</td>
                                <td>-</td>
                            </tr>
                          </tbody>
                        </table>
                        <label style="font-size: 30px; font-weight: bold;" id="bom-total-price-asset">T·ªïng gi√° tr·ªã: -</label>
                      </div>
                
                      <!-- Frame 4 -->
                      <div class="bom-frame">
                        <div class="bom-frame-title">Nh√¢n c√¥ng</div>
                        <table class="bom-table" id="table_labor">
                          <thead>
                            <tr>
                              <th>Nh√¢n c√¥ng</th>
                              <th>ƒê∆°n v·ªã</th>
                              <th>S·ªë gi·ªù c·∫ßn</th>
                              <th>Gi√° / ƒê∆°n v·ªã</th>
                              <th>T·ªïng gi√°</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>C√¥ng nh√¢n</td>
                              <td>Gi·ªù</td>
                              <td><input type="number" /></td>
                              <td>45,000</td>
                              <td>-</td>
                            </tr>
                            <tr>
                                <td>K·ªπ thu·∫≠t vi√™n</td>
                                <td>Gi·ªù</td>
                                <td><input type="number" /></td>
                                <td>55,000</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>K·ªπ s∆∞</td>
                                <td>Gi·ªù</td>
                                <td><input type="number" /></td>
                                <td>80,000</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>Chi ph√≠ kh√°c</td>
                                <td>
                                    <select>
                                      <option value="Gi·ªù">Gi·ªù</option>
                                      <option value="G√≥i">G√≥i</option>
                                    </select>
                                  </td>
                                <td><input type="number" id="others_hours" /></td>
                                <td><input type="text" id="others_cost" /></td>
                                <td>-</td>
                              </tr>
                          </tbody>
                        </table>

                        <label style="font-size: 30px; font-weight: bold;" id="bom-total-price-labor">T·ªïng gi√° tr·ªã: -</label>

                      </div>
                
                      <!-- Frame 5 -->
                      <div class="bom-frame">
                        <label style="font-size: 40px; font-weight: bold;" id="total_bom_price_final">T·ªîNG GI√Å TR·ªä C·ª¶A BOM</label>
                        <div class="bom-buttons">
                          <button style="background-color: black;" class="bom-close" onclick="hideModal_bom()">ƒê√≥ng BOM</button>
                          <button class="bom-clear" onclick="clearModalContent()">X√≥a d·ªØ li·ªáu</button>
                          <button class="bom-save" onclick="send_bom_draft()">L∆∞u BOM t·∫°m</button>
                          <button class="bom-complete" onclick="send_bom_create()">Ho√†n th√†nh BOM</button>
                        </div>
                      </div>
                    </div>
                  </div>
            </div>

            <div id="bom_approval" class="frame">
                <h1>BOM Approval</h1>

                <button class="refresh-btn" onclick="design_approval()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                  
                
                <!-- V√πng hi·ªÉn th·ªã b·∫£ng -->
                <div id="table_approve_design"></div>

                <!-- Modal container -->
                <div id="detailModal2" style="display: none;">
                    <button class="close-btn" onclick="closeModal2()">√ó</button>
                    <h2>Design Details</h2>
                
                    <div class="form-row">
                        <label>Requestor:</label>
                        <label id="operator_name_show2"></label>
                    </div>
                
                    <div class="form-row">
                        <label>Request Time:</label>
                        <label id="request_time_show2"></label>
                    </div>
                
                    <div class="form-row">
                        <label>CRM#:</label>
                        <label id="crm_show2"></label>
                    </div>

                    <div class="form-row">
                        <label>BOM#:</label>
                        <label id="bom_show2"></label>
                    </div>

                    <div class="form-row">
                        <label>Total Price:</label>
                        <label id="total_price_show2"></label>
                    </div>
                
                    <div class="form-row">
                        <label>Total Hours:</label>
                        <label id="total_hours_show2"></label>
                    </div>
                
                    <div class="form-row">
                        <label>Product Name:     </label>
                        <label id="content_show2"></label>
                    </div>
                
                    <div class="form-row">
                        <label>Link Reference:</label>
                        <label id="link_show2"></label>
                    </div>
                
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="action-btn approve-btn" onclick="approveDesign()">Approve</button>
                        <button class="action-btn reject-btn" onclick="rejectDesign()">Reject</button>
                    </div>
                </div>
                
                <div id="modalBackdrop2" style="display: none;" onclick="closeModal2()"></div>
            </div>

            <div id="quotation_approval" class="frame">
                <h1>Quotation Approval</h1>

                <button class="refresh-btn" onclick="quotation_approval()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <!-- V√πng hi·ªÉn th·ªã b·∫£ng -->
                <div id="table_approve_quotation"></div>

                <!-- Modal container -->
                <div id="detailModal3" style="display: none;">
                    <button class="close-btn" onclick="closeModal3()">√ó</button>
                    <h2>Quotation Details</h2>
                
                    <div class="form-row">
                        <label>Requestor:</label>
                        <label id="operator_name_show3"></label>
                    </div>
                
                    <div class="form-row">
                        <label>Request Time:</label>
                        <label id="request_time_show3"></label>
                    </div>
                
                    <div class="form-row">
                        <label>CRM#:</label>
                        <label id="crm_show3"></label>
                    </div>

                    <div class="form-row">
                        <label>BOM#:</label>
                        <label id="bom_show3"></label>
                    </div>

                    <div class="form-row">
                        <label>QUOTATION#:</label>
                        <label id="quotation_show3"></label>
                    </div>

                    <div class="form-row">
                        <label>Quotation Price:</label>
                        <label id="total_price_show3"></label>
                    </div>

                    <div class="form-row">
                        <label>BOM Price:</label>
                        <label id="total_bom_price_show3"></label>
                    </div>
                
                    <div class="form-row">
                        <label>Product Name:     </label>
                        <label id="content_show3"></label>
                    </div>
                
                    <div class="form-row">
                        <label>Link Reference:</label>
                        <label id="link_show3"></label>
                    </div>
                
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="action-btn approve-btn" onclick="approveQuotation()">Approve</button>
                        <button class="action-btn reject-btn" onclick="rejectQuotation()">Reject</button>
                    </div>
                </div>
                
                <div id="modalBackdrop3" style="display: none;" onclick="closeModal3()"></div>
            </div>

            <div id="pr_approval" class="frame">
                <h1>PR Approval</h1>

                <button class="refresh-btn" onclick="pr_approval()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>

                <table id="dataTable_pr" style="margin-top: 50px;">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>PR#</th>
                            <th>Requestor</th>
                            <th>Approver</th>
                            <th>Department</th>
                            <th>Warehouse</th>
                            <th>Purpose</th>
                            <th class="hidden">Spreadsheet_id</th> 
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                       
                    </tbody>
                </table>
                
                <div id="modal_pr" class="modal_pr">
                    <div class="modal-content_pr">
                        <span class="close_pr" onclick="closeModal_pr()">&times;</span>
                        <h2>Chi ti·∫øt PR</h2>
                        <div id="scroll_content"">
                            <div id="modalContent_pr">ƒêang t·∫£i...</div>
                        </div>

                        <div style="margin-top: 50px; text-align: center;">
                            <button class="action-btn approve-btn-pr">Approve</button>
                            <button class="action-btn reject-btn-pr">Reject</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="po_1_approval" class="frame">
                <h1>PO Level 1 Approval</h1>

                <button class="refresh-btn" onclick="po_1_approval()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <table id="dataTable_po" style="margin-top: 50px;">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>PO#</th>
                            <th>PR#</th>
                            <th>Vendor</th>
                            <th>PO Creator</th>
                            <th>PR Creator</th>
                            <th>PO Approver</th>
                            <th class="hidden">PDF</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Files</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Status</th>
                            <th>T·ªïng gi√° tr·ªã</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                    </tbody>
                </table>

                <div id="modal_po" class="modal_pr2" style="display: none;">
                    <div class="modal-content_pr2">
                        <span class="close_pr" onclick="closeModal_po()">&times;</span>
                        <h2>Chi ti·∫øt PO</h2>
                        <div id="scroll_content">
                            <label>Date</label>
                            <label id="po_date"></label><br>
                            <label>Time</label>
                            <label id="po_time"></label><br>
                            <label>PO#</label>
                            <label id="po_number"></label><br>
                            <label>PR#</label>
                            <label id="po_pr"></label><br>
                            <label>Vendor</label>
                            <label id="po_vendor"></label><br>
                            <label>PO Creator</label>
                            <label id="po_creator"></label><br>
                            <label>PR Creator</label>
                            <label id="po_pr_creator"></label><br>
                            <label>PO Approver</label>
                            <label id="po_approver"></label><br>
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <label id="po_total"></label><br>
                
                            <button id="po_pdf_view" style="display: none;">Xem PDF</button>
                            <button id="po_1_pdf_view_new_tab">Xem chi ti·∫øt PO</button>
                            <button id="po_fils_view">Xem Files Upload</button>
                        </div>
                
                        <!-- L√Ω do Reject (·∫®n ban ƒë·∫ßu) -->
                        <div id="reject_reason_section" style="display: none; margin-top: 15px;">
                            <label for="reject_reason">L√Ω do Reject:</label>
                            <!-- <textarea id="reject_reason" rows="3" style="width: 100%;" placeholder="Nh·∫≠p l√Ω do..."></textarea> -->
                            <select id="reject_reason">
                                <option value="" disabled selected>Ch·ªçn l√Ω do t·ª´ ch·ªëi</option>
                                <option value="Sai s√≥t trong th√¥ng tin PO">Sai s√≥t trong th√¥ng tin PO</option>
                                <option value="Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu">Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu</option>
                                <option value="PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t">PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t</option>
                                <option value="Thay ƒë·ªïi y√™u c·∫ßu">Thay ƒë·ªïi y√™u c·∫ßu</option>
                                <option value="V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n">V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n</option>
                                <option value="Ch√≠nh s√°ch v√† quy tr√¨nh">Ch√≠nh s√°ch v√† quy tr√¨nh</option>
                            </select>                              
                        </div>
                
                        <div style="margin-top: 50px; text-align: center;">
                            <button id="po_approve">Approve</button>
                            <button id="po_reject">Reject</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="po_2_approval" class="frame">
                <h1>PO Level 2 Approval</h1>

                <button class="refresh-btn" onclick="po_2_approval()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <table id="dataTable_po_2" style="margin-top: 50px;">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>PO#</th>
                            <th>PR#</th>
                            <th>Vendor</th>
                            <th>PO Creator</th>
                            <th>PR Creator</th>
                            <th class="hidden">PDF</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Files</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Status</th>
                            <th class="hidden">Reason</th>
                            <th>T·ªïng gi√° tr·ªã</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                    </tbody>
                </table>

                <div id="modal_po_2" class="modal_pr2" style="display: none;">
                    <div class="modal-content_pr2">
                        <span class="close_pr" onclick="closeModal_po_2()">&times;</span>
                        <h2>Chi ti·∫øt PO</h2>
                        <div id="scroll_content">
                            <label>Date</label>
                            <label id="po_2_date"></label><br>
                            <label>Time</label>
                            <label id="po_2_time"></label><br>
                            <label>PO#</label>
                            <label id="po_2_number"></label><br>
                            <label>PR#</label>
                            <label id="po_2_pr"></label><br>
                            <label>Vendor</label>
                            <label id="po_2_vendor"></label><br>
                            <label>PO Creator</label>
                            <label id="po_2_creator"></label><br>
                            <label>PR Creator</label>
                            <label id="po_2_pr_creator"></label><br>
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <label id="po_2_total"></label><br>
                
                            <button id="po_2_pdf_view" style="display: none;">Xem PDF</button>
                            <button id="po_2_pdf_view_new_tab">Xem chi ti·∫øt PO</button>
                            <button id="po_2_fils_view">Xem Files Upload</button>
                        </div>
                
                        <!-- L√Ω do Reject (·∫®n ban ƒë·∫ßu) -->
                        <div id="reject_reason_section_2" style="display: none; margin-top: 15px;">
                            <label for="reject_reason_2">L√Ω do Reject:</label>
                            <!-- <textarea id="reject_reason_2" rows="3" style="width: 100%;" placeholder="Nh·∫≠p l√Ω do..."></textarea> -->
                            <select id="reject_reason_2">
                                <option value="" disabled selected>Ch·ªçn l√Ω do t·ª´ ch·ªëi</option>
                                <option value="Sai s√≥t trong th√¥ng tin PO">Sai s√≥t trong th√¥ng tin PO</option>
                                <option value="Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu">Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu</option>
                                <option value="PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t">PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t</option>
                                <option value="Thay ƒë·ªïi y√™u c·∫ßu">Thay ƒë·ªïi y√™u c·∫ßu</option>
                                <option value="V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n">V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n</option>
                                <option value="Ch√≠nh s√°ch v√† quy tr√¨nh">Ch√≠nh s√°ch v√† quy tr√¨nh</option>
                            </select>  
                        </div>

                        <div style="margin-top: 50px; text-align: center;">
                            <button id="po_2_approve">Approve</button>
                            <button id="po_2_reject">Reject</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="po_3_approval" class="frame">
                <h1>PO Level 3 Approval</h1>

                <button class="refresh-btn" onclick="po_3_approval()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <table id="dataTable_po_3" style="margin-top: 50px;">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>PO#</th>
                            <th>PR#</th>
                            <th>Vendor</th>
                            <th>PO Creator</th>
                            <th>PR Creator</th>
                            <th class="hidden">PDF</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Files</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Status</th>
                            <th class="hidden">Reason</th>
                            <th>T·ªïng gi√° tr·ªã</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                    </tbody>
                </table>

                <div id="modal_po_3" class="modal_pr2" style="display: none;">
                    <div class="modal-content_pr2">
                        <span class="close_pr" onclick="closeModal_po_3()">&times;</span>
                        <h2>Chi ti·∫øt PO</h2>
                        <div id="scroll_content">
                            <label>Date</label>
                            <label id="po_3_date"></label><br>
                            <label>Time</label>
                            <label id="po_3_time"></label><br>
                            <label>PO#</label>
                            <label id="po_3_number"></label><br>
                            <label>PR#</label>
                            <label id="po_3_pr"></label><br>
                            <label>Vendor</label>
                            <label id="po_3_vendor"></label><br>
                            <label>PO Creator</label>
                            <label id="po_3_creator"></label><br>
                            <label>PR Creator</label>
                            <label id="po_3_pr_creator"></label><br>
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <label id="po_3_total"></label><br>

                            <button id="po_3_pdf_view" style="display: none;">Xem PDF</button>
                            <button id="po_3_pdf_view_new_tab">Xem chi ti·∫øt PO</button>
                            <button id="po_3_fils_view">Xem Files Upload</button>
                        </div>

                        <!-- L√Ω do Reject (·∫®n ban ƒë·∫ßu) -->
                        <div id="reject_reason_section_3" style="display: none; margin-top: 15px;">
                            <label for="reject_reason_3">L√Ω do Reject:</label>
                            <select id="reject_reason_3">
                                <option value="" disabled selected>Ch·ªçn l√Ω do t·ª´ ch·ªëi</option>
                                <option value="Sai s√≥t trong th√¥ng tin PO">Sai s√≥t trong th√¥ng tin PO</option>
                                <option value="Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu">Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu</option>
                                <option value="PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t">PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t</option>
                                <option value="Thay ƒë·ªïi y√™u c·∫ßu">Thay ƒë·ªïi y√™u c·∫ßu</option>
                                <option value="V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n">V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n</option>
                                <option value="Ch√≠nh s√°ch v√† quy tr√¨nh">Ch√≠nh s√°ch v√† quy tr√¨nh</option>
                            </select>  
                        </div>

                        <div style="margin-top: 50px; text-align: center;">
                            <button id="po_3_approve">Approve</button>
                            <button id="po_3_reject">Reject</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="po_4_approval" class="frame">
                <h1>PO Level 4 Approval</h1>

                <button class="refresh-btn" onclick="po_4_approval()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <table id="dataTable_po_4" style="margin-top: 50px;">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>PO#</th>
                            <th>PR#</th>
                            <th>Vendor</th>
                            <th>PO Creator</th>
                            <th>PR Creator</th>
                            <th class="hidden">PDF</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Files</th> <!-- C·ªôt b·ªã ·∫©n -->
                            <th class="hidden">Status</th>
                            <th class="hidden">Reason</th>
                            <th>T·ªïng gi√° tr·ªã</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
                    </tbody>
                </table>
                
                <div id="modal_po_4" class="modal_pr2" style="display: none;">
                    <div class="modal-content_pr2">
                        <span class="close_pr" onclick="closeModal_po_4()">&times;</span>
                        <h2>Chi ti·∫øt PO</h2>
                        <div id="scroll_content">
                            <label>Date</label>
                            <label id="po_4_date"></label><br>
                            <label>Time</label>
                            <label id="po_4_time"></label><br>
                            <label>PO#</label>
                            <label id="po_4_number"></label><br>
                            <label>PR#</label>
                            <label id="po_4_pr"></label><br>
                            <label>Vendor</label>
                            <label id="po_4_vendor"></label><br>
                            <label>PO Creator</label>
                            <label id="po_4_creator"></label><br>
                            <label>PR Creator</label>
                            <label id="po_4_pr_creator"></label><br>
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <label id="po_4_total"></label><br>
                
                            <button id="po_4_pdf_view" style="display: none;">Xem PDF</button>
                            <button id="po_4_pdf_view_new_tab">Xem chi ti·∫øt PO</button>
                            <button id="po_4_fils_view">Xem Files Upload</button>
                        </div>
                
                        <!-- L√Ω do Reject (·∫®n ban ƒë·∫ßu) -->
                        <div id="reject_reason_section_4" style="display: none; margin-top: 15px;">
                            <label for="reject_reason_4">L√Ω do Reject:</label>
                            <!-- <textarea id="reject_reason_4" rows="3" style="width: 100%;" placeholder="Nh·∫≠p l√Ω do..."></textarea> -->
                            <select id="reject_reason_4">
                                <option value="" disabled selected>Ch·ªçn l√Ω do t·ª´ ch·ªëi</option>
                                <option value="Sai s√≥t trong th√¥ng tin PO">Sai s√≥t trong th√¥ng tin PO</option>
                                <option value="Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu">Nh√† cung c·∫•p kh√¥ng ƒë√°p ·ª©ng y√™u c·∫ßu</option>
                                <option value="PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t">PR li√™n quan c·∫ßn c·∫≠p nh·∫≠t</option>
                                <option value="Thay ƒë·ªïi y√™u c·∫ßu">Thay ƒë·ªïi y√™u c·∫ßu</option>
                                <option value="V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n">V·∫•n ƒë·ªÅ ng√¢n s√°ch ho·∫∑c thanh to√°n</option>
                                <option value="Ch√≠nh s√°ch v√† quy tr√¨nh">Ch√≠nh s√°ch v√† quy tr√¨nh</option>
                            </select>  
                        </div>
                
                        <div style="margin-top: 50px; text-align: center;">
                            <button id="po_4_approve">Approve</button>
                            <button id="po_4_reject">Reject</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="onhand" class="frame">
                
                <h1>On-hand Inventory</h1>
                <button id="export_onhand" class="refresh-btn">Export</button>
                <button id="refresh_onhand" class="refresh-btn">Refresh</button>
                <div class="scrollable-frame">
                    <div id="tableContainer">
                        <div class="table-wrapper">
                            <div id="onhandTable"></div> <!-- Tabulator table goes here -->
                        </div>
                    </div>
                </div>
            </div>
            <div id="transaction_nhap" class="frame">
                <h1>Transaction nh·∫≠p</h1>
                <button id="export_nhap" class="refresh-btn">Export</button>
                <button id="refresh_nhap" class="refresh-btn">Refresh</button>
                <div class="scrollable-frame">
                    <div id="tableContainer">
                        <div class="table-wrapper">
                            <div id="nhapTable"></div> <!-- Tabulator table goes here -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- ######################## -->
            <!-- PURCHASE MGMT> -->
            <div id="pur_pr" class="frame">
                <h1>Purchase Request</h1>

                <div class="bom-modal" id="pr-modal">
                    <div class="bom-modal-content">
                        <h2 class="bom-title">PURCHASING REQUEST</h2>

                        <div class="pr_frame_1">
                            <div class="form-row">
                                <label for="warehouse">Ch·ªçn chi nh√°nh</label>
                                <select id="warehouse_pr">
                                    <!-- Options s·∫Ω ƒë∆∞·ª£c th√™m qua JavaScript -->
                                </select>
                            </div>

                            <div class="form-row">
                                <label for="pr_dept">B·ªô ph·∫≠n</label>
                                <input type="text" id="pr_dept" placeholder="Nh·∫≠p b·ªô ph·∫≠n" disabled>
                            </div>

                            <div class="form-row">
                                <label for="purpose_pr">M·ª•c ƒë√≠ch mua h√†ng</label>
                                <select id="purpose_pr">
                                    <option value="">-- Ch·ªçn m·ª•c ƒë√≠ch --</option>
                                    <option value="Th∆∞∆°ng m·∫°i">Th∆∞∆°ng m·∫°i</option>
                                    <option value="S·∫£n xu·∫•t">S·∫£n xu·∫•t</option>
                                    <option value="D√πng cho x∆∞·ªüng">D√πng cho x∆∞·ªüng</option>
                                    <option value="Uy√™n Long">Uy√™n Long</option>
                                    <option value="Stock kho TM/SX">Stock kho TM/SX</option>
                                    <option value="D·ªãch v·ª•">D·ªãch v·ª•</option>
                                </select>
                            </div>
                        </div>

                        <div class="pr_frame_2">
                            <button class="show-modal-button" onclick="openModal_pr_add_item()" style="background-color: #354f52;">Th√™m v·∫≠t t∆∞</button>
                            <button onclick="document.getElementById('file-upload').click()" class="show-modal-button" style="background-color: #2f3e46;">PR File Upload</button>
                            <input type="file" id="file-upload" accept=".xlsx" style="display: none;">

                            <div style="overflow-x: auto;"> <!-- Th√™m overflow-x ƒë·ªÉ c√≥ cu·ªôn ngang -->
                                <table class="bom-table" id="pr-item-table">
                                    <thead>
                                        <tr>
                                            <th>STT</th>
                                            <th>Lo·∫°i v·∫≠t t∆∞</th>
                                            <th>T√™n v·∫≠t t∆∞</th>
                                            <th>M√£ v·∫≠t t∆∞</th>
                                            <th>Th√¥ng s·ªë k·ªπ thu·∫≠t</th>
                                            <th>ƒê∆°n v·ªã</th>
                                            <th>T√™n kh√°ch h√†ng</th>
                                            <th>S·ªë PO c·ªßa kh√°ch h√†ng</th>
                                            <th>Ng√†y c·∫ßn c√≥ v·∫≠t t∆∞</th>
                                            <th>ƒê∆°n gi√° / ƒë∆°n v·ªã d·ª± ki·∫øn (VND)</th>
                                            <th>S·ªë l∆∞·ª£ng c·∫ßn</th>
                                            <th>T·ªïng ti·ªÅn</th>
                                            <th>Danh s√°ch File</th>
                                            <th>File Data</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>

                                <!-- Modal ƒë·ªÉ hi·ªÉn th·ªã b·∫£ng d·ªØ li·ªáu -->
                                <div id="excelModal" style="display:none; position:fixed; top:10%; left:10%; width:80%; height:80%; background:white; border:1px solid #ccc; padding:20px; overflow:auto;">
                                <h3>Preview D·ªØ li·ªáu Excel</h3>
                                <div id="excel-table-container"></div>
                                <button class="show-modal-button" style="background-color: #2f3e46;" onclick="closeExcelModal()">ƒê√≥ng</button>
                                <button class="show-modal-button" style="background-color: #335c67;" onclick="insertExcelToMainTable()">Mass Upload</button>
                                </div>
                            </div>

                            <div id="pr_modal_add_item" class="modal">

                                <div class="second_modal">
                                    <div id="secondaryModal_pr_type" class="modal">
                                        <div class="modal-content" style="width: 100%;">
                                            <span class="close-btn" onclick="closeModal()">x</span>
                                            <h3>Ch·ªçn v·∫≠t t∆∞</h3>
                                            <div id="modalOptions_pr_type"></div>
                                        </div>
                                    </div>
                                </div>
                            
                                <div class="bom-modal-content">
                                    <h2 class="bom-title">Nh·∫≠p Th√¥ng Tin V·∫≠t T∆∞</h2>
                                    <div class="bom-input-group">
                                        <label>Lo·∫°i v·∫≠t t∆∞: (C√≥ g·ª£i √Ω)</label>
                                        <input type="text" id="pr-type">
                                        <div id="dropdown_pr_type" class="dropdown"></div>
                                    </div>

                                    <div class="bom-input-group"><label>Th√¥ng s·ªë k·ªπ thu·∫≠t:</label>
                                        <input type="text" id="pr_specs" placeholder="Nh·∫≠p th√¥ng s·ªë k·ªπ thu·∫≠t">
                                    </div>
                                    
                                    <div class="bom-input-group">
                                        <label>T√™n kh√°ch h√†ng: (C√≥ g·ª£i √Ω)</label>
                                        <input type="text" id="pr-vendor">
                                        <div id="dropdown_pr_vendor" class="dropdown"></div>
                                    </div>
                                    <div class="bom-input-group"><label>S·ªë PO c·ªßa kh√°ch h√†ng:</label> <input type="text" id="pr_po" placeholder="Nh·∫≠p s·ªë PO"></div>
                                    <div class="bom-input-group"><label>Ng√†y c·∫ßn c√≥ v·∫≠t t∆∞:</label> <input type="date" id="pr_date"></div>
                                    <div class="bom-input-group"><label>ƒê∆°n gi√° / ƒë∆°n v·ªã d·ª± ki·∫øn (VND):</label> <input type="number" id="pr_price" placeholder="Nh·∫≠p ƒë∆°n gi√°"></div>
                                    <div class="bom-input-group"><label>S·ªë l∆∞·ª£ng c·∫ßn:</label> <input type="number" id="pr_quantity" placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng c·∫ßn"></div>

                                    <div style="text-align: center; margin-top: 30px;">
                                        <input type="file" name="file" id="fileUpload_pr" onchange="LoadFile_pr(event)" required multiple><br><br>
                        
                                        <input type="hidden" id="fileData_pr" name="fileData_pr">
                                        <input type="hidden" id="mimeType_pr" name="mimeType_pr">
                                        <input type="hidden" id="fileName_pr" name="fileName_pr">
                                    </div>
                                    <label style="margin-bottom: 20px;">L∆∞u √Ω: ƒê√≠nh k√®m t·ªëi ƒëa 3 files v√† m·ªói file kh√¥ng qu√° 10MB</label><br>

                                    <div class="bom-buttons">
                                        <button class="btn btn-confirm" onclick="addItem_pr()">X√°c nh·∫≠n</button>
                                        <button class="btn btn-close" onclick="closeModal_pr_add_item()">ƒê√≥ng</button>
                                    </div>

                                    <div class="bom-input-group"><label>T√™n v·∫≠t t∆∞:</label> <input type="text" id="pr_name" disabled></div>
                                    <div class="bom-input-group"><label>M√£ v·∫≠t t∆∞:</label> <input type="text" id="pr_code" disabled></div>
                                    <div class="bom-input-group"><label>ƒê∆°n v·ªã:</label> <input type="text" id="pr_unit" disabled></div>
                                    <div class="bom-input-group"><label>ƒê∆°n gi√°:</label> <input type="text" id="pr_unit_price" disabled></div>

                                </div>
                                
                            </div>
                        </div>

                        <div class="bom-buttons">
                            <button style="background-color: black;" class="bom-close" onclick="hideModal_pr()">ƒê√≥ng</button>
                            <button class="bom-complete" onclick="send_pr()">G·ª≠i y√™u c·∫ßu duy·ªát mua h√†ng</button>
                        </div>

                    </div>

                </div>

                <button class="show-modal-button" style="background-color: #335c67;" onclick="showModal_pr()">Create New PR</button>
            </div>
             <!-- ########################### -->

             <!-- Purchase Order> -->
            <div id="pur_po" class="frame">
                <h1>Purchase Order</h1>

                <table id="poTable" border="1">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>PR#</th>
                            <th>Requestor</th>
                            <th>Approver</th>
                            <th>Department</th>
                            <th>Warehouse</th>
                            <th>Purpose</th>
                            <th>Spreadsheet ID</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ch√®n v√†o ƒë√¢y -->
                    </tbody>
                </table>
                <!-- Modal show th√¥ng tin PR tr∆∞·ªõc khi l√†m PO -->
                <div id="prInfoModal" class="modal">
                    <div class="modal-content">
                      <!-- <span class="close" onclick="closePrInfoModal()">&times;</span> -->
                      <h3>Th√¥ng tin PR</h3>
                      <table id="modalTable" border="1"><tbody></tbody></table>
                      <button id="processPrInfo">T·∫°o PO</button>
                      <button id="closePrInfo" onclick="closePrInfoModal()">ƒê√≥ng</button>
                    </div>
                  </div>

                <!-- Modal when click into PR# -->
                <div class="bom-modal" id="po-modal">
                    <div class="bom-modal-content">
                        <h2 class="bom-title">PURCHASING ORDER</h2>
                        <div class="bom-frame-title">
                            Th√¥ng tin PR
                        </div>
                        <div class="pr_frame_1">
                            <div class="form-row">
                                <label>PR#</label>
                                <label id="po_po_label" style="width: 500px; margin-left: 35px;"></label>  
                            </div>

                            <div class="form-row">
                                <label>Chi nh√°nh</label>
                                <label id="po_wh_label"></label>  
                            </div>

                            <div class="form-row">
                                <label>Ng√†y c·∫ßn c√≥ v·∫≠t t∆∞</label>
                                <input type="text" id="po_availability_materials_date" readonly>
                            </div>

                            <div class="form-row">
                                <label>Ng√†y giao h√†ng d·ª± ki·∫øn</label>
                                <input type="date" id="po_expect_delivery_date">
                            </div>

                            <div class="form-row">
                                <label>Ng√†y thanh to√°n</label>
                                <input type="date" id="po_payment_date">
                            </div>

                            <div class="form-row">
                                <label>Ng∆∞·ªùi t·∫°o PR</label>
                                <label id="po_pr_operator_label" style="width: 500px; margin-left: 35px;"></label>  
                            </div>

                            <div class="form-row">
                                <label>Sheet ID</label>
                                <label id="po_sheet_id_label" style="width: 500px; margin-left: 35px;"></label>  
                            </div>
                        </div>

                        <div class="bom-frame-title">
                            Supplier
                        </div>
                        <div class="pr_frame_2">
                            <div class="bom-input-group">
                                <label>Company (C√≥ g·ª£i √Ω)</label>
                                <input id="po_company_input" type="text" placeholder="Nh·∫≠p t√™n c√¥ng ty">
                                <div id="dropdown_po_vendor" class="dropdown"></div>
                            </div>
                            <!-- <div class="bom-row"> -->
                                <!-- <div class="bom-left"> -->
                                <div class="square-frame">
                                    <div class="frame-title">Th√¥ng tin Supplier</div>
                                    <div class="form-row-po">
                                        <label>Address</label>
                                        <input id="po_address_input" type="text" disabled>
                                    </div>
                                
                                    <div class="form-row-po">
                                        <label>Tax Code</label>
                                        <input id="po_tax_input" type="text" disabled>
                                    </div>
                                
                                    <div class="form-row-po">
                                        <label>Bank Acc Name</label>
                                        <input id="po_bank_add_input" type="text" disabled>
                                    </div>
                                <!-- </div> -->
                                <!-- <div class="bom-right"> -->
                                    <div class="form-row-po">
                                        <label>Bank Account</label>
                                        <input id="po_bank_acc_input" type="text" disabled>
                                    </div>
                                
                                    <div class="form-row-po">
                                        <label>Bank Name</label>
                                        <input id="po_bank_name_input" type="text" disabled>
                                    </div>
                                
                                    <div class="form-row-po">
                                        <label>Swift Code</label>
                                        <input id="po_swift_input" type="text" disabled>
                                    </div>
                                </div>
                                <!-- </div>   -->
                            <!-- </div> -->
                        </div>

                        <div class="bom-frame-title">
                            Chi ti·∫øt v·∫≠t t∆∞
                        </div>
                        <div class="pr_frame_3">
                            <div style="overflow: auto;">
                                <table id="po_materialTable" class="bom-table">
                                    <thead>
                                        <tr>
                                            <th>STT</th>
                                            <th>Lo·∫°i v·∫≠t t∆∞</th>
                                            <th>T√™n v·∫≠t t∆∞</th>
                                            <th>T√™n v·∫≠t t∆∞ (ti·∫øng vi·ªát)</th>
                                            <th>M√£ v·∫≠t t∆∞</th>
                                            <th>ƒê∆°n v·ªã</th>
                                            <th>ƒê∆°n v·ªã ti·ªÅn t·ªá</th>
                                            <th>Gi√° b√°n</th>
                                            <th>Xu·∫•t x·ª© h√†ng h√≥a</th>
                                            <th>S·ªë l∆∞·ª£ng c·∫ßn mua</th>
                                            <th>ƒê∆°n gi√°</th>
                                            <th>Th√†nh ti·ªÅn</th>
                                            <th>% Thu·∫ø GTGT</th>
                                            <th>T·ªïng ti·ªÅn</th>
                                            <th>Ghi ch√∫</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ch√®n v√†o ƒë√¢y -->
                                    </tbody>
                                </table>
                            </div>
                            <label style="font-size: 30px; font-weight: bold; width: 100%;" id="po_total_price">T·ªïng gi√° tr·ªã: -</label>
                        </div>

                        <div class="bom-frame-title">
                            Th√¥ng tin giao h√†ng
                        </div>
                        <div class="pr_frame_4">
                            <div class="form-row">
                                <label style="width: 150px !important;">Delivery Address</label>
                                <input id="po_delivery_address_input" type="text" value="RMG VIETNAM CO., LTD" readonly>
                            </div>
                        </div>

                        <div class="form-row">
                            <label style="width: 150px !important;">Delivery To</label>
                            <!-- <input id="po_delivery_to_input" type="text"> -->
                            <select id="po_delivery_to_input"></select>                              
                        </div>

                        <div class="bom-row">
                            
                            <div class="bom-left">
                                
                                <div class="form-row">
                                    <label>Attts</label>
                                    <input id="po_atts_input" type="text">
                                </div>

                                <div class="form-row">
                                    <label>Phone Number</label>
                                    <input id="po_phone_input" type="text">
                                </div>

                                <div class="form-row">
                                    <label>Ship via</label>
                                    <input id="po_ship_via_input" type="text">
                                </div>

                                <div class="form-row">
                                    <label>Shipping Value</label>
                                    <input id="po_ship_value_input" type="text">
                                </div>
                            </div>

                            <div class="bom-right">
                                <div class="form-row">
                                    <label>Delivery Terms</label>
                                    <input id="po_delivery_terms_input" type="text">
                                </div>

                                <div class="form-row">
                                    <label>Payment Terms</label>
                                    <input id="po_payment_terms_input" type="text">
                                </div>

                                <div class="form-row">
                                    <label>Lead time</label>
                                    <input id="po_lead_time_input" type="text">
                                </div>

                                <div class="form-row">
                                    <label>Warranty</label>
                                    <input id="po_warranty_input" type="text">
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <label style="width: 150px !important;">Ghi ch√∫</label>
                            <textarea id="po_note" type="text" readonly></textarea>                      
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload_po" onchange="LoadFile_po(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData_po" name="fileData_po">
                            <input type="hidden" id="mimeType_po" name="mimeType_po">
                            <input type="hidden" id="fileName_po" name="fileName_po">
                        </div>
                            
                        <div class="bom-buttons">
                            <button class="bom-complete" onclick="sendPO()">G·ª≠i y√™u c·∫ßu duy·ªát PO</button>
                            <button class="bom-close" onclick="hideModal_po()">ƒê√≥ng</button>
                        </div>
                    </div>  

                </div>
            </div>

            <!-- ########################### -->

            <!-- PO RELEASE> -->
            <div id="pur_po_release" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>PO RELEASE</h1>

                        <div class="form-row">
                            <label>PR#</label>
                            <input id="pr_po_release" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>PO#</label>
                            <input id="po_po_release" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o PO</label>
                            <input id="po_creator_po_release" type="text" readonly>
                        </div>
                        

                        <div class="form-row">
                            <label>Nh√† cung c·∫•p</label>
                            <input id="vendor_po_release" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <input id="total_value_po_release" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Chi ph√≠ c·∫ßn thanh to√°n tr∆∞·ªõc</label>
                            <input id="pre_pay_po_release" type="text">
                        </div>

                        <div class="form-row">
                            <label>Chi ph√≠ c√≤n l·∫°i s·∫Ω thanh to√°n</label>
                            <input id="remain_pay_po_release" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng√†y c·∫ßn c√≥ h√†ng</label>
                            <input id="expect_recv_date_po_release" type="text" readonly>
                        </div>
                        
                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <textarea id="content_po_release"></textarea>
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload_po_release" onchange="LoadFile_po_release(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData_po_release" name="fileData_po_release">
                            <input type="hidden" id="mimeType_po_release" name="mimeType_po_release">
                            <input type="hidden" id="fileName_po_release" name="fileName_po_release">
                        </div>
            
                        <div id="button_group_po_release">
                            <button id="submitButton_po_release" class="submit-btn">RA ƒê∆†N H√ÄNG</button>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_po_release" style="overflow: auto; width: 100%; max-height: 700px; border: 1px solid #ccc;">
                            <table id="po_release_table">
                                <thead>
                                    <tr>
                                        <th>PO#</th>
                                        <th>PR#</th>
                                        <th>Vendor</th>
                                        <th>Ng∆∞·ªùi t·∫°o PO</th>
                                        <th>Ng∆∞·ªùi t·∫°o PR</th>
                                        <th>Ng√†y t·∫°o PO</th>
                                        <th>T·ªïng gi√° tr·ªã PO</th>
                                        <th>Action</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

             </div>
            <!-- ############ -->

            <!-- PO Pre-payment -->
            <div id="pur_pre_payment" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>PO PRE-PAYMENT</h1>

                        <div class="form-row">
                            <label>PR#</label>
                            <input id="pr_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>PO#</label>
                            <input id="po_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o PO</label>
                            <input id="po_creator_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o PR</label>
                            <input id="pr_creator_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <input id="total_value_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>ƒê∆°n v·ªã ti·ªÅn t·ªá</label>
                            <input id="currency_unit_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Chi ph√≠ c·∫ßn thanh to√°n tr∆∞·ªõc</label>
                            <input id="pre_pay_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Chi ph√≠ c√≤n l·∫°i s·∫Ω thanh to√°n</label>
                            <input id="remain_pay_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Nh√† cung c·∫•p</label>
                            <input id="vendor_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>ƒê·ªãa ch·ªâ</label>
                            <input id="vendor_addr_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>S·ªë ƒëi·ªán tho·∫°i</label>
                            <input id="vendor_phone_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>T√™n ng√¢n h√†ng</label>
                            <input id="vendor_bank_name_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>S·ªë t√†i kho·∫£n</label>
                            <input id="vendor_bank_acc_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng√†y thanh to√°n</label>
                            <input id="payment_date_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng√†y nh·∫≠n h√†ng d·ª± ki·∫øn</label>
                            <input id="expect_recv_date_pre_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>N·ªôi dung PO-RELEASE</label>
                            <input id="content_release_pre_payment" type="text" readonly>
                        </div>
                        
                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <textarea id="content_pre_payment"></textarea>
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload_pre_payment" onchange="LoadFile_pre_payment(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData_pre_payment" name="fileData_pre_payment">
                            <input type="hidden" id="mimeType_pre_payment" name="mimeType_pre_payment">
                            <input type="hidden" id="fileName_pre_payment" name="fileName_pre_payment">
                        </div>
            
                        <div id="button_group_pre_payment">
                            <button id="submitButton_pre_payment" class="submit-btn">ƒê√É THANH TO√ÅN TR∆Ø·ªöC</button>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_pre_payment" style="overflow: auto; width: 100%; max-height: 700px; border: 1px solid #ccc;">
                            <table id="pre_payment_table">
                                <thead>
                                    <tr>
                                        <th>PO#</th>
                                        <th>PR#</th>
                                        <th>Vendor</th>
                                        <th>T·ªïng gi√° tr·ªã PO</th>
                                        <th>Thanh to√°n tr∆∞·ªõc</th>
                                        <th>Ng∆∞·ªùi t·∫°o PO</th>
                                        <th>Action</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

             </div>
            <!-- ############ -->

            <!-- PO RECEIVING -->
            <div id="pur_po_receiving" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>PO RECEIVING</h1>

                        <div class="form-row">
                            <label>PR#</label>
                            <input id="pr_po_receiving" type="text" readonly>
                        </div>

                        <!-- <div class="form-row">
                            <label>Ng√†y nh·∫≠n h√†ng</label>
                            <input id="expect_recv_date_po_receiving" type="text" readonly>
                        </div> -->

                        <div class="form-row">
                            <label>PO#</label>
                            <input id="po_po_receiving" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <input id="total_value_po_receiving" type="text" readonly>
                        </div>
                    
                        <div class="form-row">
                            <label>N·ªôi dung PO PRE-PAYMENT</label>
                            <input id="content_pre_pay_po_receiving" type="text" readonly>
                        </div>
                        
                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <textarea id="content_po_receiving"></textarea>
                        </div>

                        <button id="view_po_detail_at_receiving"> Xem chi ti·∫øt PO</button>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload_po_receiving" onchange="LoadFile_po_receiving(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData_po_receiving" name="fileData_po_receiving">
                            <input type="hidden" id="mimeType_po_receiving" name="mimeType_po_receiving">
                            <input type="hidden" id="fileName_po_receiving" name="fileName_po_receiving">
                        </div>
            
                        <div id="button_group_po_receiving">
                            <button id="submitButton_po_receiving" class="submit-btn">ƒê√É NH·∫¨N H√ÄNG</button>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_po_receiving" style="overflow: auto; width: 100%; max-height: 400px; border: 1px solid #ccc;">
                            <table id="po_receiving_table">
                                <thead>
                                    <tr>
                                        <th>PO#</th>
                                        <th>PR#</th>
                                        <th>Ng√†y nh·∫≠n h√†ng</th>
                                        <th>Vendor</th>
                                        <th>Ng∆∞·ªùi t·∫°o PO</th>
                                        <th>Ng∆∞·ªùi t·∫°o PR</th>
                                        <th>Action</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

             </div>
            <!-- ############ -->

            <!-- PO Final Payment -->
            <div id="pur_final_payment" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>PO FINAL PAYMENT</h1>

                        <div class="form-row">
                            <label>PR#</label>
                            <input id="pr_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>PO#</label>
                            <input id="po_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o PO</label>
                            <input id="po_creator_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o PR</label>
                            <input id="pr_creator_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <input id="total_value_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>ƒê∆°n v·ªã ti·ªÅn t·ªá</label>
                            <input id="currency_unit_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Chi ph√≠ c·∫ßn thanh to√°n tr∆∞·ªõc</label>
                            <input id="pre_pay_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Chi ph√≠ c√≤n l·∫°i s·∫Ω thanh to√°n</label>
                            <input id="remain_pay_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Nh√† cung c·∫•p</label>
                            <input id="vendor_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>ƒê·ªãa ch·ªâ</label>
                            <input id="vendor_addr_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>S·ªë ƒëi·ªán tho·∫°i</label>
                            <input id="vendor_phone_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>T√™n ng√¢n h√†ng</label>
                            <input id="vendor_bank_name_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>S·ªë t√†i kho·∫£n</label>
                            <input id="vendor_bank_acc_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng√†y thanh to√°n</label>
                            <input id="payment_date_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng√†y nh·∫≠n h√†ng d·ª± ki·∫øn</label>
                            <input id="expect_recv_date_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>N·ªôi dung PO-RECEIVING</label>
                            <input id="content_release_final_payment" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Xem Files ƒë√≠nh k√®m</label>
                            <div id="files_final_payment"></div> <!-- Chuy·ªÉn t·ª´ button sang div -->
                        </div>
                        
                        
                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <textarea id="content_final_payment"></textarea>
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload_final_payment" onchange="LoadFile_final_payment(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData_final_payment" name="fileData_final_payment">
                            <input type="hidden" id="mimeType_final_payment" name="mimeType_final_payment">
                            <input type="hidden" id="fileName_final_payment" name="fileName_final_payment">
                        </div>
            
                        <div id="button_group_final_payment">
                            <button id="submitButton_final_payment" class="submit-btn">ƒê√É THANH TO√ÅN</button>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_final_payment" style="overflow: auto; width: 100%; max-height: 700px; border: 1px solid #ccc;">
                            <table id="final_payment_table">
                                <thead>
                                    <tr>
                                        <th>PO#</th>
                                        <th>PR#</th>
                                        <th>Vendor</th>
                                        <th>Ng√†y thanh to√°n</th>
                                        <th>S·ªë ti·ªÅn c√≤n l·∫°i</th>
                                        <th>Ng∆∞·ªùi t·∫°o PO</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

             </div>
            <!-- ############ -->

            <!-- PO COMPLETE -->
            <div id="pur_po_complete" class="frame">
                <div class="frame2">
                    <div id="div1" class="left-frame">
                        <h1>PO COMPLETE</h1>

                        <div class="form-row">
                            <label>PR#</label>
                            <input id="pr_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>PO#</label>
                            <input id="po_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o PO</label>
                            <input id="po_creator_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng∆∞·ªùi t·∫°o PR</label>
                            <input id="pr_creator_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>T·ªïng gi√° tr·ªã PO</label>
                            <input id="total_value_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Nh√† cung c·∫•p</label>
                            <input id="vendor_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>Ng√†y nh·∫≠n h√†ng d·ª± ki·∫øn</label>
                            <input id="expect_recv_date_po_complete" type="text" readonly>
                        </div>

                        <!-- <div class="form-row">
                            <label>Xem Files ƒë√≠nh k√®m</label>
                            <div id="files_po_complete"></div> 
                        </div> -->

                        <div class="form-row">
                            <label>T√™n KH khi t·∫°o PR</label>
                            <input id="customer_name_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>S·ªë PO c·ªßa KH khi t·∫°o PR</label>
                            <input id="po_number_po_complete" type="text" readonly>
                        </div>

                        <div class="form-row">
                            <label>C·∫≠p nh·∫≠t s·ªë PO ch√≠nh th·ª©c c·ªßa KH</label>
                            <input id="official_po_complete" type="text" style="background-color: lightyellow;">
                        </div>
                        
                        
                        <div class="form-row">
                            <label>N·ªôi dung</label>
                            <textarea id="content_po_complete"></textarea>
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <input type="file" name="file" id="fileUpload_po_complete" onchange="LoadFile_po_complete(event)" required multiple><br><br>
            
                            <input type="hidden" id="fileData_po_complete" name="fileData_po_complete">
                            <input type="hidden" id="mimeType_po_complete" name="mimeType_po_complete">
                            <input type="hidden" id="fileName_po_complete" name="fileName_po_complete">
                        </div>
            
                        <div id="button_group_po_complete">
                            <button id="submitButton_po_complete" class="submit-btn">PO COMPLETED</button>
                        </div>
                    </div>

                    <div id="div2" class="right-frame">
                        <h1>Danh s√°ch ch·ªù x·ª≠ l√Ω</h1>

                        <div id="table-container_po_complete" style="overflow: auto; width: 100%; max-height: 700px; border: 1px solid #ccc;">
                            <table id="po_complete_table">
                                <thead>
                                    <tr>
                                        <th>PO#</th>
                                        <th>PR#</th>
                                        <th>Vendor</th>
                                        <th>Ng√†y thanh to√°n</th>
                                        <th>Ng∆∞·ªùi t·∫°o PO</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>

             </div>
            <!-- ############ -->

            <!-- PR PO Summary -->
            <div id="pr_po_summary" class="frame">
                <h1>T√¨nh tr·∫°ng PR-PO</h1>
                <button class="refresh-btn" onclick="get_pr_po_summary()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>

                <button class="refresh-btn" onclick="clearFilters_pur_summary()" style="margin-left: 20px; background-color: red;">
                    <i class="fas fa-eraser"></i> Clear Filter
                </button>
                

                <div class="frame3">
                    <div class="form-row">
                        <label>Ng√†y t·∫°o PR (T·ª´ - ƒê·∫øn):</label>
                        <input type="date" id="filter-pr-date-from">
                        <input type="date" id="filter-pr-date-to">
                    </div>

                    <div class="form-row">
                        <label>Ng√†y t·∫°o PO (T·ª´ - ƒê·∫øn):</label>
                        <input type="date" id="filter-po-date-from">
                        <input type="date" id="filter-po-date-to">
                    </div>

                    <div class="form-row">
                        <label>Ng∆∞·ªùi t·∫°o PO:</label>
                        <select id="filter-creator-po">
                            <option value="">T·∫•t c·∫£</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label>Ng∆∞·ªùi t·∫°o PR:</label>
                        <select id="filter-creator-pr">
                            <option value="">T·∫•t c·∫£</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <label>Chi nh√°nh:</label>
                        <select id="pur-filter-branch">
                            <option value="">T·∫•t c·∫£</option>
                        </select>
                    </div>
                </div>

                <div style="height: 500px; overflow: auto;">
                    <table id="data-table-summary">
                        <thead></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- ############## -->

            <div id="transaction_xuat" class="frame">
                <h1>Transaction Xu·∫•t</h1>
                <button id="export_xuat" class="refresh-btn">Export</button>
                <button id="refresh_xuat" class="refresh-btn">Refresh</button>
                <div class="scrollable-frame">
                    <div id="tableContainer">
                        <div class="table-wrapper">
                            <div id="xuatTable"></div> <!-- Tabulator table goes here -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="export_pr" class="frame">
                <h1>Xu·∫•t chi ti·∫øt PR / PO</h1>
                <button id="export_pr_btn" class="refresh-btn" onclick="updateAndLoadPR()">Xu·∫•t PR</button>
                <button id="export_po_btn" class="refresh-btn" onclick="updateAndLoadPO()">Xu·∫•t PO</button>
                
                <!-- modal export PR -->
                <div id="pr_export_modal" class="modal">
                    <div class="modal-content">
                      <span onclick="document.getElementById('pr_export_modal').style.display='none'">&times;</span>
                      <h3>L·ªçc d·ªØ li·ªáu PR</h3>
                  
                      <label for="pr_export_modal_date">Ng√†y t·∫°o PR:</label>
                      <input type="date" id="pr_export_modal_date" />
                  
                      <label for="pr_export_modal_branch">Chi nh√°nh:</label>
                      <select id="pr_export_modal_branch">
                        <option value="">-- T·∫•t c·∫£ --</option>
                      </select>
                  
                      <label for="pr_export_modal_operator">Operator:</label>
                      <select id="pr_export_modal_operator">
                        <option value="">-- T·∫•t c·∫£ --</option>
                      </select>
                  
                      <button style="background-color: green; width: 100px;" onclick="filterAndExportPR()">Xu·∫•t Excel</button>
                      <button style="width: 100px;" onclick="hideModalExportPR()">ƒê√≥ng</button>
                    </div>
                  </div>

                  <!-- modal export PO -->
                <div id="po_export_modal" class="modal">
                    <div class="modal-content">
                      <span onclick="document.getElementById('po_export_modal').style.display='none'">&times;</span>
                      <h3>L·ªçc d·ªØ li·ªáu PO</h3>
                  
                      <label for="po_export_modal_date">Ng√†y t·∫°o PR:</label>
                      <input type="date" id="po_export_modal_date" />
                  
                      <label for="po_export_modal_branch">Chi nh√°nh:</label>
                      <select id="po_export_modal_branch">
                        <option value="">-- T·∫•t c·∫£ --</option>
                      </select>
                  
                      <label for="po_export_modal_operator">Operator:</label>
                      <select id="po_export_modal_operator">
                        <option value="">-- T·∫•t c·∫£ --</option>
                      </select>
                  
                      <button style="background-color: green; width: 100px;" onclick="filterAndExportPO()">Xu·∫•t Excel</button>
                      <button style="width: 100px;" onclick="hideModalExportPO()">ƒê√≥ng</button>
                    </div>
                  </div>
                  
            </div>

        <!-- Modal -->
        <div id="filterModal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>Filter Options</h2>
                
                <label for="selectFilter">Ch·ªçn chi nh√°nh</label>
                <select id="selectFilter">
                    
                </select>
                
                <label for="dateFrom">Date From</label>
                <input type="date" id="dateFrom">
                
                <label for="dateTo">Date To</label>
                <input type="date" id="dateTo">
                
                <button id="applyFilter">Apply Filter and Export</button>
                <button id="closeModal">Close</button>
            </div>
        </div>

        <div id="filterModal2" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>Filter Options</h2>
                
                <label for="selectFilter">Ch·ªçn chi nh√°nh</label>
                <select id="selectFilter2">
                    
                </select>
                
                <label for="dateFrom">Date From</label>
                <input type="date" id="dateFrom2">
                
                <label for="dateTo">Date To</label>
                <input type="date" id="dateTo2">
                
                <button id="applyFilter2">Apply Filter and Export</button>
                <button id="closeModal2">Close</button>
            </div>
        </div>

        <div id="filterModal3" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>Filter Options</h2>
                
                <label for="selectFilter">Ch·ªçn chi nh√°nh</label>
                <select id="selectFilter3">
                    
                </select>
                
                <button id="applyFilter3">Apply Filter and Export</button>
                <button id="closeModal3">Close</button>
            </div>
        </div>

        <!-- Modal -->
        <div id="cancelModal" class="modal">
            <div class="modal-content" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                <div class="modal-header">
                    <strong>Cancel Reason</strong>
                </div>
                <div class="modal-body">
                    <form id="cancelForm">
                        <select id="cancelReason" style="width: 100%; padding: 5px; margin-top: 10px;">
                            <option value="">-- Ch·ªçn l√Ω do --</option>
                            <option value="Gi√° cao">1. Gi√° cao</option>
                            <option value="Th·ªùi gian giao h√†ng l√¢u">2. Th·ªùi gian giao h√†ng l√¢u</option>
                            <option value="Kh√°ch h√†ng thay ƒë·ªïi k·∫ø ho·∫°ch">3. Kh√°ch h√†ng thay ƒë·ªïi k·∫ø ho·∫°ch</option>
                            <option value="Kh√°ch h√†ng h·ªßy nhu c·∫ßu">4. Kh√°ch h√†ng h·ªßy nhu c·∫ßu</option>
                            <option value="RMG kh√¥ng ƒë√°p ·ª©ng ƒë∆∞·ª£c y√™u c·∫ßu leadtime">5. RMG kh√¥ng ƒë√°p ·ª©ng ƒë∆∞·ª£c y√™u c·∫ßu leadtime</option>
                            <option value="RMG kh√¥ng ƒë√°p ·ª©ng ƒë∆∞·ª£c y√™u c·∫ßu k·ªπ thu·∫≠t">6. RMG kh√¥ng ƒë√°p ·ª©ng ƒë∆∞·ª£c y√™u c·∫ßu k·ªπ thu·∫≠t</option>
                            <option value="other">7. Kh√°c</option>
                        </select>
                        <div style="margin-top: 10px;">
                            <input type="text" id="otherReasonInput" placeholder="Nh·∫≠p l√Ω do h·ªßy" style="display: none;">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button id="submitBtn" style="background-color: green;">Submit</button>
                    <button id="closeModalBtn">Close</button>
                </div>
            </div>
        </div>

        <!-- cancel PO -->
        <div id="cancelPOModal" style="display:none; position:fixed; top:20%; left:30%; background:white; padding:20px; border:1px solid gray; z-index:1000;">
            <h3>Cancel PO</h3>
            <label>PO/PR ID:</label><br>
            <input type="text" id="cancelPoId" readonly><br><br>
            <label>L√Ω do h·ªßy:</label><br>
            <textarea id="cancelPoReason" rows="4" cols="40"></textarea><br><br>
            <button onclick="confirmCancelPO()">X√°c nh·∫≠n</button>
            <button onclick="closeCancelPO()">ƒê√≥ng</button>
        </div>
        
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>
